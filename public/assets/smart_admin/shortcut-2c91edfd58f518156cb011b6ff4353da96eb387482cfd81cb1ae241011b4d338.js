!function(e,t,n,i){function o(t,n){this.obj=e(t),this.o=e.extend({},e.fn[r].defaults,n),this.objId=this.obj.attr("id"),this.pwCtrls=".jarviswidget-ctrls",this.widget=this.obj.find(this.o.widgets),this.toggleClass=this.o.toggleClass.split("|"),this.editClass=this.o.editClass.split("|"),this.fullscreenClass=this.o.fullscreenClass.split("|"),this.customClass=this.o.customClass.split("|"),this.storage={enabled:this.o.localStorage},this.initialized=!1,this.init()}var r="jarvisWidgets",s=("ontouchstart"in t||t.DocumentTouch&&n instanceof DocumentTouch?"touchstart":"click")+"."+r;o.prototype={_runLoaderWidget:function(e){var t=this;t.o.indicator===!0&&e.parents(t.o.widgets).find(".jarviswidget-loader:first").stop(!0,!0).fadeIn(100).delay(t.o.indicatorTime).fadeOut(100)},_getPastTimestamp:function(e){var t=this,n=new Date(e),i=n.getMonth()+1,o=n.getDate(),r=n.getFullYear(),s=n.getHours(),a=n.getMinutes(),l=n.getUTCSeconds();10>i&&(i="0"+i),10>o&&(o="0"+o),10>s&&(s="0"+s),10>a&&(a="0"+a),10>l&&(l="0"+l);var c=t.o.timestampFormat.replace(/%d%/g,o).replace(/%m%/g,i).replace(/%y%/g,r).replace(/%h%/g,s).replace(/%i%/g,a).replace(/%s%/g,l);return c},_loadAjaxFile:function(t,n,i){var o=this;t.find(".widget-body").load(n,function(n,i,r){var s=e(this);if("error"==i&&s.html('<h4 class="alert alert-danger">'+o.o.labelError+"<b> "+r.status+" "+r.statusText+"</b></h4>"),"success"==i){var a=t.find(o.o.timestampPlaceholder);a.length&&a.html(o._getPastTimestamp(new Date)),"function"==typeof o.o.afterLoad&&o.o.afterLoad.call(this,t)}o=null}),this._runLoaderWidget(i)},_loadKeys:function(){var e=this;if(e.o.ajaxnav===!0){var t=location.hash.replace(/^#/,"");e.storage.keySettings="Plugin_settings_"+t+"_"+e.objId,e.storage.keyPosition="Plugin_position_"+t+"_"+e.objId}else if(e.initialized===!1){var t=e.o.pageKey||location.pathname;e.storage.keySettings="jarvisWidgets_settings_"+t+"_"+e.objId,e.storage.keyPosition="jarvisWidgets_position_"+t+"_"+e.objId}},_saveSettingsWidget:function(){var t=this,n=t.storage;t._loadKeys();var i=t.obj.find(t.o.widgets).map(function(){var t={};return t.id=e(this).attr("id"),t.style=e(this).attr("data-widget-attstyle"),t.title=e(this).children("header").children("h2").text(),t.hidden="none"==e(this).css("display")?1:0,t.collapsed=e(this).hasClass("jarviswidget-collapsed")?1:0,t}).get(),o=JSON.stringify({widget:i});n.enabled&&n.getKeySettings!=o&&(localStorage.setItem(n.keySettings,o),n.getKeySettings=o),"function"==typeof t.o.onSave&&t.o.onSave.call(this,null,o,n.keySettings)},_savePositionWidget:function(){var t=this,n=t.storage;t._loadKeys();var i=t.obj.find(t.o.grid+".sortable-grid").map(function(){var n=e(this).children(t.o.widgets).map(function(){return{id:e(this).attr("id")}}).get();return{section:n}}).get(),o=JSON.stringify({grid:i});n.enabled&&n.getKeyPosition!=o&&(localStorage.setItem(n.keyPosition,o),n.getKeyPosition=o),"function"==typeof t.o.onSave&&t.o.onSave.call(this,o,n.keyPosition)},init:function(){var t=this;if(!t.initialized){if(t._initStorage(t.storage),e("#"+t.objId).length||alert("It looks like your using a class instead of an ID, dont do that!"),t.o.rtl===!0&&e("body").addClass("rtl"),e(t.o.grid).each(function(){e(this).find(t.o.widgets).length&&e(this).addClass("sortable-grid")}),t.storage.enabled&&t.storage.getKeyPosition){var n=JSON.parse(t.storage.getKeyPosition);for(var o in n.grid){var a=t.obj.find(t.o.grid+".sortable-grid").eq(o);for(var l in n.grid[o].section)a.append(e("#"+n.grid[o].section[l].id))}}if(t.storage.enabled&&t.storage.getKeySettings){var c=JSON.parse(t.storage.getKeySettings);for(var o in c.widget){var u=e("#"+c.widget[o].id);c.widget[o].style&&u.removeClassPrefix("jarviswidget-color-").addClass(c.widget[o].style).attr("data-widget-attstyle",""+c.widget[o].style),1==c.widget[o].hidden?u.hide(1):u.show(1).removeAttr("data-widget-hidden"),1==c.widget[o].collapsed&&u.addClass("jarviswidget-collapsed").children("div").hide(1),u.children("header").children("h2").text()!=c.widget[o].title&&u.children("header").children("h2").text(c.widget[o].title)}}if(t.widget.each(function(){var n,o,r,s,a,l,c,u,d=e(this),h=e(this).children("header");if(!h.parent().attr("role")){d.data("widget-hidden")===!0&&d.hide(),d.data("widget-collapsed")===!0&&d.addClass("jarviswidget-collapsed").children("div").hide(),n=t.o.customButton===!0&&d.data("widget-custombutton")===i&&0!==t.customClass[0].length?'<a href="javascript:void(0);" class="button-icon jarviswidget-custom-btn"><i class="'+t.customClass[0]+'"></i></a>':"",o=t.o.deleteButton===!0&&d.data("widget-deletebutton")===i?'<a href="javascript:void(0);" class="button-icon jarviswidget-delete-btn" rel="tooltip" title="Delete" data-placement="bottom"><i class="'+t.o.deleteClass+'"></i></a>':"",r=t.o.editButton===!0&&d.data("widget-editbutton")===i?'<a href="javascript:void(0);" class="button-icon jarviswidget-edit-btn" rel="tooltip" title="Edit" data-placement="bottom"><i class="'+t.editClass[0]+'"></i></a>':"",s=t.o.fullscreenButton===!0&&d.data("widget-fullscreenbutton")===i?'<a href="javascript:void(0);" class="button-icon jarviswidget-fullscreen-btn" rel="tooltip" title="Fullscreen" data-placement="bottom"><i class="'+t.fullscreenClass[0]+'"></i></a>':"",t.o.colorButton===!0&&d.data("widget-colorbutton")===i?(a='<a data-toggle="dropdown" class="dropdown-toggle color-box selector" href="javascript:void(0);"></a><ul class="dropdown-menu arrow-box-up-right color-select pull-right"><li><span class="bg-color-green" data-widget-setstyle="jarviswidget-color-green" rel="tooltip" data-placement="left" data-original-title="Green Grass"></span></li><li><span class="bg-color-greenDark" data-widget-setstyle="jarviswidget-color-greenDark" rel="tooltip" data-placement="top" data-original-title="Dark Green"></span></li><li><span class="bg-color-greenLight" data-widget-setstyle="jarviswidget-color-greenLight" rel="tooltip" data-placement="top" data-original-title="Light Green"></span></li><li><span class="bg-color-purple" data-widget-setstyle="jarviswidget-color-purple" rel="tooltip" data-placement="top" data-original-title="Purple"></span></li><li><span class="bg-color-magenta" data-widget-setstyle="jarviswidget-color-magenta" rel="tooltip" data-placement="top" data-original-title="Magenta"></span></li><li><span class="bg-color-pink" data-widget-setstyle="jarviswidget-color-pink" rel="tooltip" data-placement="right" data-original-title="Pink"></span></li><li><span class="bg-color-pinkDark" data-widget-setstyle="jarviswidget-color-pinkDark" rel="tooltip" data-placement="left" data-original-title="Fade Pink"></span></li><li><span class="bg-color-blueLight" data-widget-setstyle="jarviswidget-color-blueLight" rel="tooltip" data-placement="top" data-original-title="Light Blue"></span></li><li><span class="bg-color-teal" data-widget-setstyle="jarviswidget-color-teal" rel="tooltip" data-placement="top" data-original-title="Teal"></span></li><li><span class="bg-color-blue" data-widget-setstyle="jarviswidget-color-blue" rel="tooltip" data-placement="top" data-original-title="Ocean Blue"></span></li><li><span class="bg-color-blueDark" data-widget-setstyle="jarviswidget-color-blueDark" rel="tooltip" data-placement="top" data-original-title="Night Sky"></span></li><li><span class="bg-color-darken" data-widget-setstyle="jarviswidget-color-darken" rel="tooltip" data-placement="right" data-original-title="Night"></span></li><li><span class="bg-color-yellow" data-widget-setstyle="jarviswidget-color-yellow" rel="tooltip" data-placement="left" data-original-title="Day Light"></span></li><li><span class="bg-color-orange" data-widget-setstyle="jarviswidget-color-orange" rel="tooltip" data-placement="bottom" data-original-title="Orange"></span></li><li><span class="bg-color-orangeDark" data-widget-setstyle="jarviswidget-color-orangeDark" rel="tooltip" data-placement="bottom" data-original-title="Dark Orange"></span></li><li><span class="bg-color-red" data-widget-setstyle="jarviswidget-color-red" rel="tooltip" data-placement="bottom" data-original-title="Red Rose"></span></li><li><span class="bg-color-redLight" data-widget-setstyle="jarviswidget-color-redLight" rel="tooltip" data-placement="bottom" data-original-title="Light Red"></span></li><li><span class="bg-color-white" data-widget-setstyle="jarviswidget-color-white" rel="tooltip" data-placement="right" data-original-title="Purity"></span></li><li><a href="javascript:void(0);" class="jarviswidget-remove-colors" data-widget-setstyle="" rel="tooltip" data-placement="bottom" data-original-title="Reset widget color to default">Remove</a></li></ul>',h.prepend('<div class="widget-toolbar">'+a+"</div>")):a="",t.o.toggleButton===!0&&d.data("widget-togglebutton")===i?(c=d.data("widget-collapsed")===!0||d.hasClass("jarviswidget-collapsed")?t.toggleClass[1]:t.toggleClass[0],l='<a href="javascript:void(0);" class="button-icon jarviswidget-toggle-btn" rel="tooltip" title="Collapse" data-placement="bottom"><i class="'+c+'"></i></a>'):l="",u=t.o.refreshButton===!0&&d.data("widget-refreshbutton")!==!1&&d.data("widget-load")?'<a href="javascript:void(0);" class="button-icon jarviswidget-refresh-btn" data-loading-text="&nbsp;&nbsp;Loading...&nbsp;" rel="tooltip" title="Refresh" data-placement="bottom"><i class="'+t.o.refreshButtonClass+'"></i></a>':"";var f=t.o.buttonOrder.replace(/%refresh%/g,u).replace(/%delete%/g,o).replace(/%custom%/g,n).replace(/%fullscreen%/g,s).replace(/%edit%/g,r).replace(/%toggle%/g,l);(""!==u||""!==o||""!==n||""!==s||""!==r||""!==l)&&h.prepend('<div class="jarviswidget-ctrls">'+f+"</div>"),t.o.sortable===!0&&d.data("widget-sortable")===i&&d.addClass("jarviswidget-sortable"),d.find(t.o.editPlaceholder).length&&d.find(t.o.editPlaceholder).find("input").val(e.trim(h.children("h2").text())),h.append('<span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>'),d.attr("role","widget").children("div").attr("role","content").prev("header").attr("role","heading").children("div").attr("role","menu")}}),t.o.buttonsHidden===!0&&e(t.o.pwCtrls).hide(),e(".jarviswidget header [rel=tooltip]").tooltip(),t.obj.find("[data-widget-load]").each(function(){var n=e(this),i=n.children(),o=n.data("widget-load"),r=1e3*n.data("widget-refresh");n.children(),n.find(".jarviswidget-ajax-placeholder").length||(n.children("widget-body").append('<div class="jarviswidget-ajax-placeholder">'+t.o.loadingLabel+"</div>"),n.data("widget-refresh")>0?(t._loadAjaxFile(n,o,i),e.intervalArr.push(setInterval(function(){t._loadAjaxFile(n,o,i)},r))):t._loadAjaxFile(n,o,i))}),t.o.sortable===!0&&jQuery.ui){var d=t.obj.find(t.o.grid+".sortable-grid").not("[data-widget-excludegrid]");d.sortable({items:d.find(t.o.widgets+".jarviswidget-sortable"),connectWith:d,placeholder:t.o.placeholderClass,cursor:"move",revert:!0,opacity:t.o.opacity,delay:200,cancel:".button-icon, #jarviswidget-fullscreen-mode > div",zIndex:1e4,handle:t.o.dragHandle,forcePlaceholderSize:!0,forceHelperSize:!0,update:function(e,n){t._runLoaderWidget(n.item.children()),t._savePositionWidget(),"function"==typeof t.o.onChange&&t.o.onChange.call(this,n.item)}})}t.o.buttonsHidden===!0&&t.widget.children("header").on("mouseenter."+r,function(){e(this).children(t.o.pwCtrls).stop(!0,!0).fadeTo(100,1)}).on("mouseleave."+r,function(){e(this).children(t.o.pwCtrls).stop(!0,!0).fadeTo(100,0)}),t._clickEvents(),t.storage.enabled&&(e(t.o.deleteSettingsKey).on(s,this,function(e){var n=confirm(t.o.settingsKeyLabel);n&&localStorage.removeItem(keySettings),e.preventDefault()}),e(t.o.deletePositionKey).on(s,this,function(e){var n=confirm(t.o.positionKeyLabel);n&&localStorage.removeItem(keyPosition),e.preventDefault()})),initialized=!0}},_initStorage:function(e){e.enabled=e.enabled&&!!function(){var e,t=+new Date;try{return localStorage.setItem(t,t),e=localStorage.getItem(t)==t,localStorage.removeItem(t),e}catch(e){}}(),this._loadKeys(),e.enabled&&(e.getKeySettings=localStorage.getItem(e.keySettings),e.getKeyPosition=localStorage.getItem(e.keyPosition))},_clickEvents:function(){function n(){if(e("#jarviswidget-fullscreen-mode").length){var n=e(t).height(),o=e("#jarviswidget-fullscreen-mode").children(i.o.widgets).children("header").height();e("#jarviswidget-fullscreen-mode").children(i.o.widgets).children("div").height(n-o-15)}}var i=this,o=i.widget.children("header");o.on(s,".jarviswidget-toggle-btn",function(t){var n=e(this),o=n.parents(i.o.widgets);i._runLoaderWidget(n),o.hasClass("jarviswidget-collapsed")?n.children().removeClass(i.toggleClass[1]).addClass(i.toggleClass[0]).parents(i.o.widgets).removeClass("jarviswidget-collapsed").children("[role=content]").slideDown(i.o.toggleSpeed,function(){i._saveSettingsWidget()}):n.children().removeClass(i.toggleClass[0]).addClass(i.toggleClass[1]).parents(i.o.widgets).addClass("jarviswidget-collapsed").children("[role=content]").slideUp(i.o.toggleSpeed,function(){i._saveSettingsWidget()}),"function"==typeof i.o.onToggle&&i.o.onToggle.call(this,o),t.preventDefault()}),o.on(s,".jarviswidget-fullscreen-btn",function(t){var o=e(this).parents(i.o.widgets),r=o.children("div");i._runLoaderWidget(e(this)),e("#jarviswidget-fullscreen-mode").length?(e(".nooverflow").removeClass("nooverflow"),o.unwrap("<div>").children("div").removeAttr("style").end().find(".jarviswidget-fullscreen-btn:first").children().removeClass(i.fullscreenClass[1]).addClass(i.fullscreenClass[0]).parents(i.pwCtrls).children("a").show(),r.hasClass("jarviswidget-visible")&&r.hide().removeClass("jarviswidget-visible")):(e("body").addClass("nooverflow"),o.wrap('<div id="jarviswidget-fullscreen-mode"/>').parent().find(".jarviswidget-fullscreen-btn:first").children().removeClass(i.fullscreenClass[0]).addClass(i.fullscreenClass[1]).parents(i.pwCtrls).children("a:not(.jarviswidget-fullscreen-btn)").hide(),r.is(":hidden")&&r.show().addClass("jarviswidget-visible")),n(),"function"==typeof i.o.onFullscreen&&i.o.onFullscreen.call(this,o),t.preventDefault()}),e(t).on("resize."+r,function(){n()}),o.on(s,".jarviswidget-edit-btn",function(t){var n=e(this).parents(i.o.widgets);i._runLoaderWidget(e(this)),n.find(i.o.editPlaceholder).is(":visible")?e(this).children().removeClass(i.editClass[1]).addClass(i.editClass[0]).parents(i.o.widgets).find(i.o.editPlaceholder).slideUp(i.o.editSpeed,function(){i._saveSettingsWidget()}):e(this).children().removeClass(i.editClass[0]).addClass(i.editClass[1]).parents(i.o.widgets).find(i.o.editPlaceholder).slideDown(i.o.editSpeed),"function"==typeof i.o.onEdit&&i.o.onEdit.call(this,n),t.preventDefault()}),e(i.o.editPlaceholder).find("input").keyup(function(){e(this).parents(i.o.widgets).children("header").children("h2").text(e(this).val())}),o.on(s,"[data-widget-setstyle]",function(t){var n=e(this).data("widget-setstyle"),o="";e(this).parents(i.o.editPlaceholder).find("[data-widget-setstyle]").each(function(){o+=e(this).data("widget-setstyle")+" "}),e(this).parents(i.o.widgets).attr("data-widget-attstyle",""+n).removeClassPrefix("jarviswidget-color-").addClass(n),i._runLoaderWidget(e(this)),i._saveSettingsWidget(),t.preventDefault()}),o.on(s,".jarviswidget-custom-btn",function(t){var n=e(this).parents(i.o.widgets);i._runLoaderWidget(e(this)),e(this).children("."+i.customClass[0]).length?(e(this).children().removeClass(i.customClass[0]).addClass(i.customClass[1]),"function"==typeof i.o.customStart&&i.o.customStart.call(this,n)):(e(this).children().removeClass(i.customClass[1]).addClass(i.customClass[0]),"function"==typeof i.o.customEnd&&i.o.customEnd.call(this,n)),i._saveSettingsWidget(),t.preventDefault()}),o.on(s,".jarviswidget-delete-btn",function(t){var n=e(this).parents(i.o.widgets),o=n.attr("id"),r=n.children("header").children("h2").text();e.SmartMessageBox?e.SmartMessageBox({title:"<i class='fa fa-times' style='color:#ed1c24'></i> "+i.o.labelDelete+' "'+r+'"',content:i.o.deleteMsg,buttons:"[No][Yes]"},function(t){"Yes"==t&&(i._runLoaderWidget(e(this)),e("#"+o).fadeOut(i.o.deleteSpeed,function(){e(this).remove(),"function"==typeof i.o.onDelete&&i.o.onDelete.call(this,n)}))}):e("#"+o).fadeOut(i.o.deleteSpeed,function(){e(this).remove(),"function"==typeof i.o.onDelete&&i.o.onDelete.call(this,n)}),t.preventDefault()}),o.on(s,".jarviswidget-refresh-btn",function(t){var n=e(this).parents(i.o.widgets),o=n.data("widget-load"),r=n.children(),s=e(this);s.button("loading"),r.addClass("widget-body-ajax-loading"),setTimeout(function(){s.button("reset"),r.removeClass("widget-body-ajax-loading"),i._loadAjaxFile(n,o,r)},1e3),t.preventDefault()}),o=null},destroy:function(){var n=this,i="."+r,o=n.obj.find(n.o.grid+".sortable-grid").not("[data-widget-excludegrid]");o.sortable("destroy"),n.widget.children("header").off(i),e(n.o.deleteSettingsKey).off(i),e(n.o.deletePositionKey).off(i),e(t).off(i),n.obj.removeData(r)}},e.fn[r]=function(t){return this.each(function(){var n=e(this),i=n.data(r);if(!i){var s="object"==typeof t&&t;n.data(r,i=new o(this,s))}"string"==typeof t&&i[t]()})},e.fn[r].defaults={grid:"section",widgets:".jarviswidget",localStorage:!0,deleteSettingsKey:"",settingsKeyLabel:"Reset settings?",deletePositionKey:"",positionKeyLabel:"Reset position?",sortable:!0,buttonsHidden:!1,toggleButton:!0,toggleClass:"min-10 | plus-10",toggleSpeed:200,onToggle:function(){},deleteButton:!0,deleteMsg:"Warning: This action cannot be undone",deleteClass:"trashcan-10",deleteSpeed:200,onDelete:function(){},editButton:!0,editPlaceholder:".jarviswidget-editbox",editClass:"pencil-10 | delete-10",editSpeed:200,onEdit:function(){},colorButton:!0,fullscreenButton:!0,fullscreenClass:"fullscreen-10 | normalscreen-10",fullscreenDiff:3,onFullscreen:function(){},customButton:!0,customClass:"",customStart:function(){},customEnd:function(){},buttonOrder:"%refresh% %delete% %custom% %edit% %fullscreen% %toggle%",opacity:1,dragHandle:"> header",placeholderClass:"jarviswidget-placeholder",indicator:!0,indicatorTime:600,ajax:!0,loadingLabel:"loading...",timestampPlaceholder:".jarviswidget-timestamp",timestampFormat:"Last update: %m%/%d%/%y% %h%:%i%:%s%",refreshButton:!0,refreshButtonClass:"refresh-10",labelError:"Sorry but there was a error:",labelUpdated:"Last Update:",labelRefresh:"Refresh",labelDelete:"Delete widget:",afterLoad:function(){},rtl:!1,onChange:function(){},onSave:function(){},ajaxnav:!0},e.fn.removeClassPrefix=function(t){return this.each(function(n,i){var o=i.className.split(" ").map(function(e){return 0===e.indexOf(t)?"":e});i.className=e.trim(o.join(" "))}),this}}(jQuery,window,document);