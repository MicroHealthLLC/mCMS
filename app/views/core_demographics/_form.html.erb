<fieldset>
  <legend></legend>
  <div class="col-sm-4 col-md-3 col-lg-3">

    <div class="row">
      <div id="files" class="files col-xs-12" >
        <%= render partial: 'uploader/display_image', locals: {user: core_demographic.user} %>
      </div>
      <div  class="files col-xs-12 col-sm-12 col-md-10 col-lg-8 margin-top-10"  align="center">
        <%= render partial: 'uploader/upload' %>
      </div>

    </div>
  </div>
  <div class="col-sm-8 col-md-9 col-lg-9">
    <%= form_for([core_demographic.user, core_demographic], html: { class: 'form-horizontal', id: 'core-demo-form' }) do |f| %>
        <% if core_demographic.errors.any? %>
            <div id="error_explanation">
              <h2><%= pluralize(core_demographic.errors.count, "error") %> prohibited this core_demographic from being saved:</h2>

              <ul>
                <% core_demographic.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                <% end %>
              </ul>
            </div>
        <% end %>

        <%= f.hidden_field :user_id %>

        <div class="form-group">
          <%= f.label t('title'), class: 'col-md-2 control-label' %>
          <div class="col-md-8">
            <%= f.text_field :title, placeholder: 'Title', class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <%= f.label t('profile.first_name'), class: 'col-md-2 control-label' %>
          <div class="col-md-8">
            <%= f.text_field :first_name, placeholder: 'First name', class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <%= f.label t('profile.middle_name'), class: 'col-md-2 control-label' %>
          <div class="col-md-8">
            <%= f.text_field :middle_name, placeholder: 'Middle name', class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <%= f.label t('profile.last_name'), class: 'col-md-2 control-label' %>
          <div class="col-md-8">
            <%= f.text_field :last_name, placeholder: 'Last name', class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.gender') %></label>
          <div class="col-md-8">
            <%= f.select :gender_id, options_for_select(GenderType.active.pluck(:name, :id), selected: core_demographic.gender_type.try(:id)), {},{class: 'form-control'} %>
          </div>
        </div>
        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.birthday') %></label>
          <div class="col-md-8">
            <%= f.text_field :birth_date, class: 'form-control birthday', data: {dateformat: "yy-mm-dd"} %>
            <script>
              $(function(){
                $('.birthday').datepicker({
                  dateFormat: 'yy-mm-dd',
                  "prevText":'<i class="fa fa-chevron-left"></i>',
                  "nextText":'<i class="fa fa-chevron-right"></i>',
                  changeMonth: true,
                  changeYear: true,
                  yearRange: "-100:+0"
                });
              })
            </script>
          </div>
        </div>
        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.religion') %></label>
          <div class="col-md-8">
            <%= text_field_tag :snomed, f.object.religion,  class: 'form-control' %>
            <%= f.hidden_field :religion %>
            <script>
              $(document).ready(function(){
                $('#snomed').autocomplete({
                  source: "/snomed.json?default=religion",
                  minLength: 2,
                  select: function( event, ui ) {
                    $('#core_demographic_religion').val(ui.item.id)
                  }
                })
              })
            </script>

          </div>
        </div>
        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('label_note') %></label>
          <div class="col-md-8">
            <%= f.text_area :note, class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.ethnicity') %></label>
          <div class="col-md-8">
            <%= text_field_tag :snomed_ethnicity, f.object.ethnicity,  class: 'form-control' %>
            <%= f.hidden_field :ethnicity %>
            <script>
              $(document).ready(function(){
                $('#snomed_ethnicity').autocomplete({
                  source: "/snomed.json?default=ethnic",
                  minLength: 2,
                  select: function( event, ui ) {
                    $('#core_demographic_ethnicity').val(ui.item.id)
                  }
                })
              })
            </script>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.marital_status') %></label>
          <div class="col-md-8">
            <%= f.select :marital_status_id, options_for_select(MaritalStatus.active.pluck(:name, :id), selected: f.object.marital_status.try(:id)) , {},{class: 'form-control'} %>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label"><%= t('profile.citizenship') %></label>
          <div class="col-md-8">
            <%= f.select :citizenship_type_id, options_for_select(CitizenshipType.active.pluck(:name, :id), selected: f.object.citizenship_type.try(:id)) , {},{class: 'form-control'} %>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label">Height</label>
          <div class="col-md-8">
            <%= f.number_field :height, class: 'form-control' %>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label">Weight</label>
          <div class="col-md-8">
            <%= f.number_field :weight, class: 'form-control' %>
          </div>
        </div>

        <div class="form-group" >
          <div class="col-md-11" >
            <%= f.submit t(:button_save), class: 'btn btn-primary pull-right col-xs-4 col-sm-2 col-md-2' %>
          </div>
        </div>

    <% end %>
  </div>
</fieldset>
<script>
  // Validation
  $(function() {
    runAllForms();
    // Validation
    $("#core-demo-form").validate({

      // Rules for form validation
      rules : {
        "core_demographic[first_name]" : {
          required : true
        },
        "core_demographic[last_name]" : {
          required : true
        },
        "core_demographic[gender_id]" : {
          required : true
        },
        "core_demographic[birth_date]" : {
          required : true
        },
        "core_demographic[religion_id]" : {
          required : true
        }
      },

      // Messages for form validation
      messages : {
        login : {
          required : 'Please enter your login'
        },
        email : {
          required : 'Please enter your email address',
          email : 'Please enter a VALID email address'
        },
        password : {
          required : 'Please enter your password'
        },
        passwordConfirm : {
          required : 'Please enter your password one more time',
          equalTo : 'Please enter the same password as above'
        }
      },
      // Do not change code below
      errorPlacement : function(error, element) {
        error.insertAfter(element.parent());
      }
    });

  });
</script>